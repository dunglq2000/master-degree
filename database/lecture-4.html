<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Русский язык" href="../russian/README.html" /><link rel="prev" title="Лекция 3. Apache Spark: Часть 1" href="lecture-3.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Лекция 4. Apache Spark: Часть 2 - Đây là tiêu đề</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/myfile.css?v=d8e435fa" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../intro.html"><div class="brand">Đây là tiêu đề</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../intro.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Đây là tiêu đề</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">БСРФ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../banking-system-russia/README.html">Банковская система РФ</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../banking-system-russia/chapter-1.html">Глава 1 - Современная банковская система Российской Федерации</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Глава 1 - Современная банковская система Российской Федерации</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-1.html">Законодательный и доктринальные подходы к определению структуры российской банковской системы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-2.html">Представительства иностранных банков</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-3.html">Банковские группы и банковские холдинги</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-4.html">Ассоциации и союзы кредитных организаций</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-5.html">Банк развития</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-6.html">Кредитные потребительские кооперативы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-7.html">Ломбарды</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-8.html">Микрофинансовые организации</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-9.html">Кредитные брокеры</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-10.html">Коллекторские агентства</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-11.html">Платежные агенты и банковские платежные агенты</a></li>
<li class="toctree-l2"><a class="reference internal" href="../banking-system-russia/section-12.html">Финансовый омбудсмен</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Методология и организация научных исследований</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../methodology-research/README.html">Методология и организация научных исследований</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../methodology-research/book-0-chap-0.html">ВВЕДЕНИЕ</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of ВВЕДЕНИЕ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-chap-1.html">Глава 1. МЕТОДОЛОГИЧЕСКИЕ ОСНОВЫ НАУЧНОГО ЗНАНИЯ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-chap-2.html">Глава 2. ВЫБОР НАПРАВЛЕНИЯ НАУЧНОГО ИССЛЕДОВАНИЯ. ПОСТАНОВКА НАУЧНО-ТЕХНИЧЕСКОЙ ПРОБЛЕМЫ И ЭТАПЫ НАУЧНО-ИССЛЕДОВАТЕЛЬСКОЙ РАБОТЫ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-chap-3.html">Глава 3. ПОИСК, НАКОПЛЕНИЕ И ОБРАБОТКА НАУЧНОЙ ИНФОРМАЦИИ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-chap-4.html">Глава 4. ТЕОРЕТИЧЕСКИЕ И ЭКСПЕРИМЕНТАЛЬНЫЕ ИССЛЕДОВАНИЯ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-chap-5.html">Глава 5. ОБРАБОТКА РЕЗУЛЬТАТОВ ЭКСПЕРИМЕНТАЛЬНЫХ ИССЛЕДОВАНИЙ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-chap-6.html">Глава 6. ПОНЯТИЕ И СТРУКТУРА МАГИСТЕРСКОЙ ДИССЕРТАЦИИ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-chap-7.html">Глава 7. ОСНОВЫ ИЗОБРЕТАТЕЛЬСКОГО ТВОРЧЕСТВА</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-chap-8.html">Глава 8. ОРГАНИЗАЦИЯ НАУЧНОГО КОЛЛЕКТИВА. ОСОБЕННОСТИ НАУЧНОЙ ДЕЯТЕЛЬНОСТИ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-chap-9.html">Глава 9. РОЛЬ НАУКИ В СОВРЕМЕННОМ ОБЩЕСТВЕ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../methodology-research/book-0-bib.html">СПИСОК ЛИТЕРАТУРЫ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../methodology-research/book-1.html">МАГИСТЕРСКАЯ ДИССЕРТАЦИЯ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../methodology-research/control.html">Примерные вопросы по курсу «МЕТОДОЛОГИЯ И ОРГАНИЗАЦИЯ НАУЧНЫХ ИССЛЕДОВАНИЙ»</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ИРФМ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../infores-finmon/lectures.html">1.5. Технологии информирования</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infores-finmon/lecture-intro.html">Информация. Свойства информации</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infores-finmon/lecture-1.html">Введение в информационные системы и технологии</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infores-finmon/lecture-5IS.html">Глава 5ИС. Лингвистическое обеспечение ИС.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infores-finmon/lecture-5.html">Глава 5. Методы автоматической обработки и лексического анализа документальной информации</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infores-finmon/lecture-6.html">Глава 6. Поисковые задачи, средства и технологии информационного поиска</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Актуальные подходы к обеспечению безопасности информации</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../infosec/lectures.html">Актуальные подходы к обеспечению безопасности информации</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Национальная система по ПОД/ФТ</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../CML-TF/README.html">Национальная система по противодействию легализации преступных доходов и финансированию терроризма</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Национальная система по противодействию легализации преступных доходов и финансированию терроризма</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../CML-TF/lecture-1.html">Лекция 1. Понятие «отмывание денег». Макроэкономические последствия отмывания денег</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CML-TF/lecture-2.html">Лекция 2. Экономические и правовые основы международной системы противодействия легализации (отмывания) преступных доходов и финансирования терроризма</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CML-TF/lecture-3.html">Лекция 3. Международные стандарты ПОД/ФТ/ФРОМУ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CML-TF/lecture-4.html">Лекция 4. Международные стандарты ПОД/ФТ/ФРОМУ. Часть 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CML-TF/lecture-5.html">Лекция 5. Система противодействия финансированию терроризма</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CML-TF/lecture-6.html">Лекция 6. Основные этапы становления национальной системы ПОД/ФТ</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Специальные технологии БД и ИС</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Специальные технологии баз данных и информационных систем</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-1.html">Лекция 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-2.html">Лекция 2 - Введение в Hadoop</a></li>
<li class="toctree-l1"><a class="reference internal" href="lecture-3.html">Лекция 3. Apache Spark: Часть 1</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Лекция 4. Apache Spark: Часть 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Руский язык</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../russian/README.html">Русский язык</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/executablebooks/jupyter-book/blob/main/database/lecture-4.md?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/executablebooks/jupyter-book/edit/main/database/lecture-4.md" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="apache-spark-2">
<h1>Лекция 4. Apache Spark: Часть 2<a class="headerlink" href="#apache-spark-2" title="Link to this heading">¶</a></h1>
<section id="id1">
<h2>Структура задания<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>Приложение Spark соответствует набору заданий Spark, определяемому одним объектом SparkSession в драйверной программе.</p>
<p>Ứng dụng Spark tương ứng với một tập hợp các công việc Spark được xác định bởi một đối tượng SparkSession duy nhất trong chương trình trình điều khiển.</p>
<hr class="docutils" />
<p>Приложение Spark «ничего не делает» до тех пор, пока драйверная программа не вызовет действие. При каждом вызове действия планировщик Spark строит граф выполнения и запускает <strong>задание Spark</strong> (Spark job)</p>
<p>Ứng dụng Spark “không làm gì” cho đến khi chương trình trình điều khiển gọi hành động. Mỗi khi một hành động được gọi, bộ lập lịch Spark sẽ xây dựng một biểu đồ thực thi và chạy <strong>Spark job</strong> (Spark job)</p>
<hr class="docutils" />
<p>Задание Spark состоит из <strong>этапов</strong> (stage), представляющих собой шаги преобразования данных, необходимые для формирования итогового набора RDD.</p>
<p>Công việc Spark bao gồm <strong>giai đoạn</strong> (giai đoạn), là các bước chuyển đổi dữ liệu cần thiết để tạo bộ RDD cuối cùng.</p>
<hr class="docutils" />
<p>Этап состоит из набора <strong>задач</strong> (tasks), каждая из которых означает параллельное вычисление, выполняемое на исполнителе. Секции в итоговом RDD данного этапа соответствует одна <strong>задача</strong> (task).</p>
<p>Một giai đoạn bao gồm một tập hợp các <strong>tác vụ</strong>, mỗi tác vụ đại diện cho một phép tính song song được thực hiện trên một trình thực thi. Phần trong RDD cuối cùng của giai đoạn này tương ứng với một <strong>nhiệm vụ</strong> (nhiệm vụ).</p>
<figure class="align-default">
<img alt="../_images/4-1.png" src="../_images/4-1.png" />
</figure>
</section>
<section id="id2">
<h2>Пример структуры задания<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">simpleSparkProgramm</span><span class="p">(</span><span class="n">rdd</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nc">RDD</span><span class="p">[</span><span class="nc">Double</span><span class="p">]):</span><span class="w"> </span><span class="nc">Long</span><span class="w"> </span><span class="o">=</span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Этап 1</span>
<span class="w">    </span><span class="n">rdd</span><span class="p">.</span><span class="n">filter</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">1000.0</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="c1">// Этап 2</span>
<span class="w">        </span><span class="p">.</span><span class="n">groupByKey</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="n">map</span><span class="p">{</span><span class="w"> </span><span class="k">case</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">groups</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">groups</span><span class="p">.</span><span class="n">sum</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">)}</span>
<span class="w">    </span><span class="c1">// Этап 3</span>
<span class="w">        </span><span class="p">.</span><span class="n">sortByKey</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="n">count</span>
<span class="p">}</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/4-2.png" src="../_images/4-2.png" />
</figure>
</section>
<section id="rdd">
<h2>Основные свойства RDD<a class="headerlink" href="#rdd" title="Link to this heading">¶</a></h2>
<p>Для внутренних целей Spark использует для представления RDD пять основных свойств. Из них, три обязательных свойства.</p>
<ul class="simple">
<li><p>список объектов секций, составляющих набор RDD</p></li>
<li><p>функция вычисления итератора секции</p></li>
<li><p>список зависимостей от других наборов</p></li>
</ul>
<p>Trong nội bộ, Spark sử dụng năm thuộc tính cơ bản để thể hiện RDD. Trong số này, có ba thuộc tính bắt buộc.</p>
<ul class="simple">
<li><p>danh sách các đối tượng phần tạo nên bộ RDD</p></li>
<li><p>hàm tính toán phần lặp</p></li>
<li><p>danh sách phụ thuộc vào các bộ khác</p></li>
</ul>
<hr class="docutils" />
<p>Пять свойств соответствуют следующим доступным конечному пользователю (то есть вам) пяти методам.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">partitions()</span></code> — возвращает массив объектов секций, составляющих части распределенного набора данных. Если речь идет об RDD с объектом partitioner, то значение индекса каждой из секций будет соответствовать значению, возвращаемому функцией getPartition для каждого ключа данных, относящегося к этой секции.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iterator(p,</span> <span class="pre">parentIters)</span></code> — вычисляет элементы секции p с помощью заданных итераторов для каждой из ее родительских секций. Эта функция вызывается для вычисления каждой из секций данного RDD. Она не предназначена для непосредственного вызова пользователем, а применяется фреймворком Spark при вычислении действий.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dependencies()</span></code> — возвращает последовательность объектов зависимостей. Благодаря зависимостям планировщик знает, как данный RDD зависит от других. Существует два вида зависимостей: узкие (объекты NarrowDependency), соответствующие секциям, зависящим от одной или небольшого количества родительских секций, и широкие (объекты ShuffleDependency), используемые в случаях, когда для вычисления секции необходима перегруппировка всех данных из родительских секций. Мы обсудим эти типы зависимостей в подразделе «Широкие и узкие зависимости» далее в текущем разделе.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">partitioner()</span></code> — возвращает вариантный тип Scala для объекта partitioner, если между element и partition объекта RDD есть связанная с ним функция, например hashPartitioner. Эта функция возвращает None для всех наборов RDD, чей тип не кортеж (которые не представляют данные типа «ключ — значение»). У представляющего HDFS-файл набора (реализован в NewHadoopRDD.scala) каждому блоку файла соответствует секция.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preferredLocations(p)</span></code> — возвращает информацию о локальности данных секции p. Точнее говоря, эта функция возвращает последовательность строк с информацией о каждом из узлов, на которых хранятся фрагменты p. В случае представляющего HDFS-файл набора RDD каждая строка возвращаемого функцией preferredLocations результата представляет собой Hadoop-имя узла, в котором хранится данная секция.</p></li>
</ul>
<p>Năm thuộc tính tương ứng với năm phương thức sau đây có sẵn cho người dùng cuối (tức là bạn).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">partitions()</span></code> - trả về một mảng các đối tượng phân vùng tạo nên các phần của tập dữ liệu phân tán. Nếu chúng ta đang nói về một RDD có đối tượng phân vùng thì giá trị chỉ mục của mỗi phân vùng sẽ tương ứng với giá trị được hàm getPartition trả về cho từng khóa dữ liệu liên quan đến phân vùng đó.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iterator(p,</span> <span class="pre">parentIters)</span></code> - tính toán các phần tử của phần p bằng cách sử dụng các trình vòng lặp đã cho cho từng phần cha của nó. Hàm này được gọi để tính toán từng phần của RDD nhất định. Nó không nhằm mục đích được người dùng gọi trực tiếp mà được sử dụng bởi khung Spark khi tính toán các hành động.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dependency()</span></code> - trả về một chuỗi các đối tượng phụ thuộc. Nhờ sự phụ thuộc, bộ lập lịch biết RDD nhất định phụ thuộc vào người khác như thế nào. Có hai loại phụ thuộc: hẹp (đối tượng Phụ thuộc hẹp), tương ứng với các phân vùng phụ thuộc vào một hoặc một số ít phân vùng cha và rộng (đối tượng ShuffleDependency), được sử dụng trong trường hợp cần tập hợp lại tất cả dữ liệu từ phân vùng cha để tính toán phân vùng. Chúng ta sẽ thảo luận về các loại phụ thuộc này trong tiểu mục “Phụ thuộc rộng và hẹp” ở phần sau của phần này.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">partitioner()</span></code> - Trả về loại biến thể Scala cho một đối tượng phân vùng nếu có hàm liên kết giữa phần tử và phân vùng của đối tượng RDD, chẳng hạn như hashPartitioner. Hàm này trả về Không có cho tất cả các RDD có loại không phải là bộ dữ liệu (không biểu thị dữ liệu khóa-giá trị). Tập hợp đại diện cho tệp HDFS (được triển khai trong NewHadoopRDD.scala) có phần tương ứng cho mỗi khối của tệp.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preferredLocations(p)</span></code> - trả về thông tin về vị trí dữ liệu của phần p. Chính xác hơn, hàm này trả về một chuỗi các chuỗi có thông tin về từng nút lưu trữ các đoạn của p. Trong trường hợp một tập hợp RDD đại diện cho tệp HDFS, mỗi hàng kết quả được trả về bởi hàm PreferLocations đại diện cho tên Hadoop của nút trong đó phần này được lưu trữ.</p></li>
</ul>
</section>
<section id="id3">
<h2>Широкие и узкие зависимости<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<p>Самая важная информация, которую нужно знать о преобразованиях для понимания механизма вычисления наборов RDD, — то, что они делятся на две категории:</p>
<ul class="simple">
<li><p>преобразования с узкими зависимостями (narrow dependencies)</p></li>
<li><p>преобразования с широкими зависимостями (wide dependencies).</p></li>
</ul>
<p>Thông tin quan trọng nhất bạn cần biết về các phép biến đổi để hiểu cách tính các bộ RDD là chúng thuộc hai loại:</p>
<ul class="simple">
<li><p>biến đổi với sự phụ thuộc hẹp</p></li>
<li><p>biến đổi với sự phụ thuộc rộng rãi.</p></li>
</ul>
<figure class="align-default">
<img alt="../_images/4-3.png" src="../_images/4-3.png" />
</figure>
</section>
<section id="big-data">
<h2>Форматы файлов Big Data<a class="headerlink" href="#big-data" title="Link to this heading">¶</a></h2>
<p>Все многообразие файловых форматов Big Data (AVRO, Sequence, Parquet, ORC, RCFile) можно разделить на 2 категории: <strong>линейные</strong> (строковые) и <strong>колоночные</strong> (столбцовые).</p>
<ul class="simple">
<li><p><strong>В линейных форматах</strong> (AVRO, Sequence) строки данных одного типа хранятся вместе, образуя непрерывное хранилище. Даже если необходимо получить лишь некоторые значения из строки, все равно вся строка будет считана с диска в память.</p></li>
<li><p>Линейный способ хранения данных обусловливает пониженную скорость операций чтения и выполнении избирательных запросов, а также больший расход дискового пространства.</p></li>
<li><p>Степень сжатия информации у строковых форматов ниже, чем у столбцовых.</p></li>
<li><p>Линейно-ориентированные форматы лучше всего подходят для потоковой записи, т.к. в случае сбоя информация может быть восстановлена (повторно синхронизирована) с последней точки синхронизации.</p></li>
</ul>
<p>Toàn bộ các định dạng tệp Dữ liệu lớn (AVRO, Sequence, Parquet, ORC, RCFile) có thể được chia thành 2 loại: <strong>tuyến tính</strong> (hàng) và <strong>cột</strong> (cột).</p>
<ul class="simple">
<li><p><strong>Ở định dạng tuyến tính</strong> (AVRO, Sequence), các hàng dữ liệu cùng loại được lưu trữ cùng nhau, tạo thành một kho lưu trữ liền kề. Ngay cả khi bạn chỉ cần lấy một số giá trị từ một chuỗi thì toàn bộ chuỗi đó vẫn sẽ được đọc từ đĩa vào bộ nhớ.</p></li>
<li><p>Phương pháp lưu trữ dữ liệu tuyến tính khiến tốc độ đọc và thực hiện các truy vấn chọn lọc thấp hơn cũng như tiêu tốn nhiều dung lượng ổ đĩa hơn.</p></li>
<li><p>Mức độ nén thông tin đối với định dạng hàng thấp hơn so với định dạng cột.</p></li>
<li><p>Các định dạng hướng dòng phù hợp nhất để ghi trực tuyến vì… Trong trường hợp xảy ra lỗi, thông tin có thể được khôi phục (đồng bộ lại) từ điểm đồng bộ hóa cuối cùng.</p></li>
</ul>
<figure class="align-default">
<img alt="../_images/4-4.png" src="../_images/4-4.png" />
</figure>
<p><strong>В колоночно-ориентированных форматах</strong> (Parquet, RCFile, ORCFile) файл разрезается на несколько столбцов данных, которые хранятся вместе, но могут быть обработаны независимо друг от друга.</p>
<ul class="simple">
<li><p>Метод хранения информации позволяет пропускать ненужные столбцы при чтении данных, что существенно ускоряет чтение данных и отлично подходит в случае, когда необходим небольшой объем строк или выполняются избирательные запросы</p></li>
<li><p>Такой формат чтения и записи занимает больше места в оперативной памяти, поскольку, чтобы получить столбец из нескольких строк, кэшируется каждая строка.</p></li>
<li><p>Колоночно-ориентированные форматы не используются в средах потоковой обработки (Apache Kafka, Flume), т.к. после сбоя записи текущий файл не сможет быть восстановлен из-за отсутствия точек синхронизации.</p></li>
<li><p>Колоночные файлы занимают меньше места на жестком диске вследствие более эффективного сжатия информации по столбцам</p></li>
</ul>
<p><strong>Ở các định dạng hướng theo cột</strong> (Parquet, RCFile, ORCFile), tệp được cắt thành nhiều cột dữ liệu được lưu trữ cùng nhau nhưng có thể được xử lý độc lập với nhau.</p>
<ul class="simple">
<li><p>Phương pháp lưu trữ thông tin cho phép bạn bỏ qua các cột không cần thiết khi đọc dữ liệu, giúp tăng tốc đáng kể việc đọc dữ liệu và rất tuyệt vời khi cần một lượng hàng nhỏ hoặc thực hiện các truy vấn chọn lọc</p></li>
<li><p>Định dạng đọc-ghi này chiếm nhiều dung lượng RAM hơn vì mỗi hàng được lưu vào bộ đệm để lấy một cột gồm nhiều hàng.</p></li>
<li><p>Các định dạng hướng theo cột không được sử dụng trong môi trường xử lý luồng (Apache Kafka, Flume), vì Sau khi ghi thất bại, tệp hiện tại không thể được khôi phục do thiếu điểm đồng bộ hóa.</p></li>
<li><p>Tệp cột chiếm ít dung lượng trên ổ cứng của bạn hơn do nén thông tin qua các cột hiệu quả hơn</p></li>
</ul>
<figure class="align-default">
<img alt="../_images/4-5.png" src="../_images/4-5.png" />
</figure>
</section>
<section id="big-data-parquet">
<h2>Форматы файлов Big Data/Parquet<a class="headerlink" href="#big-data-parquet" title="Link to this heading">¶</a></h2>
<p><strong>Apache Parquet</strong> — это бинарный, колоночно-ориентированный (столбцовый) формат хранения больших данных.</p>
<p><strong>Apache Parquet</strong> là định dạng nhị phân, định hướng theo cột để lưu trữ dữ liệu lớn.</p>
<hr class="docutils" />
<p>Созданный специально для экосистемы Hadoop, он позволяет эффективно сжимать информацию и считывать файлы частично, по мере необходимых столбцов. <strong>Паркет</strong> предоставляет возможность задавать схемы сжатия на уровне столбцов и добавлять новые кодировки по мере их изобретения и реализации.</p>
<p>Được thiết kế dành riêng cho hệ sinh thái Hadoop, nó cho phép bạn nén thông tin một cách hiệu quả và đọc một phần tệp theo các cột bắt buộc. <strong>Sàn gỗ</strong> cung cấp khả năng chỉ định các sơ đồ nén cấp cột và thêm các mã hóa mới khi chúng được phát minh và triển khai.</p>
<hr class="docutils" />
<p>Паркет поддерживает наиболее распространенные типы данных (boolean, int32, int64, int96, float, double, byte_array) и реализует многоуровневую систему разбиения файлов на части (группы строк, блок данных столбца и разбиение столбцов по страницам), благодаря чему обеспечивается высокая скорость работы с данными.</p>
<hr class="docutils" />
<p>Parquet hỗ trợ các loại dữ liệu phổ biến nhất (boolean, int32, int64, int96, float, double, byte_array) và triển khai hệ thống đa cấp để chia tệp thành các phần (nhóm hàng, khối dữ liệu cột và phân trang cột), đảm bảo tốc độ cao về làm việc với dữ liệu.</p>
<hr class="docutils" />
<section id="id4">
<h3>Плюсы<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>экономия места</strong> для хранения данных за счет эффективного сжатия информации по столбцам– в частности, по сравнению с Apache Avro, другим популярным форматом Big Data, Паркет сжимает данные примерно в 3,5 раза лучше;</p></li>
<li><p><strong>высокая скорость</strong> чтения данных и отработки запросов, извлекающих определенные значения столбцов вместо считывания всего большого файла, что значительно ускоряет работу аналитика Big Data;</p></li>
<li><p><strong>возможность реализации собственных схем данных</strong> и применения различных методов кодирования к различным столбцам;</p></li>
<li><p><strong>поддержка нескольких языков программирования</strong> (C++, Java, Python, PHP и т.д.), а также популярных реймворков, например, Apache Thrift, что повышает гибкость формата;</p></li>
<li><p><strong>возможность хранения данных не только в HDFS</strong>, для которой Parquet и был создан изначально, но и в других файловых системах (GlusterFs, NFS и пр.);</p></li>
<li><p><strong>простота и удобство работы с файлами</strong> с помощью операций перемещения, резервного копирования и реплицирования;</p></li>
<li><p><strong>поддержка Apache Spark «по умолчанию»</strong> (из коробки) обеспечивает возможность сохранить файл Big Data в другое облачное или локальное хранилище данных.</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>tiết kiệm không gian</strong> để lưu trữ dữ liệu nhờ nén thông tin hiệu quả giữa các cột – đặc biệt, so với Apache Avro, một định dạng Dữ liệu lớn phổ biến khác, Parquet nén dữ liệu tốt hơn khoảng 3,5 lần;</p></li>
<li><p><strong>tốc độ cao</strong> đọc dữ liệu và chạy truy vấn truy xuất các giá trị cột cụ thể thay vì đọc toàn bộ tệp lớn, giúp tăng tốc đáng kể công việc của nhà phân tích Dữ liệu lớn;</p></li>
<li><p><strong>khả năng triển khai sơ đồ dữ liệu của riêng bạn</strong> và áp dụng các phương pháp mã hóa khác nhau cho các cột khác nhau;</p></li>
<li><p><strong>hỗ trợ một số ngôn ngữ lập trình</strong> (C++, Java, Python, PHP, v.v.), cũng như các khung phổ biến, ví dụ: Apache Thrift, giúp tăng tính linh hoạt của định dạng;</p></li>
<li><p><strong>khả năng lưu trữ dữ liệu không chỉ trong HDFS</strong>, Parquet được tạo ban đầu mà còn trong các hệ thống tệp khác (GlusterFs, NFS, v.v.);</p></li>
<li><p><strong>đơn giản và thuận tiện khi làm việc với các tập tin</strong> bằng cách sử dụng các thao tác di chuyển, sao lưu và sao chép;</p></li>
<li><p><strong>Hỗ trợ Apache Spark “theo mặc định”</strong> (có sẵn) cung cấp khả năng lưu tệp Dữ liệu lớn vào một đám mây khác hoặc bộ lưu trữ dữ liệu cục bộ.</p></li>
</ul>
</section>
<section id="id5">
<h3>Минусы<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>строгая типизация данных</strong> – в связи с колоночной ориентацией файл формата Паркет ведёт себя как неизменяемая таблица или база данных, когда для столбца четко определён тип данных, при этом невозможно его изменить или скомбинировать, например, объединив вложенный json с простым строковым значением.</p></li>
<li><p><strong>отсутствие встроенной (нативной) поддержки</strong> в других фреймворках Big Data, кромеApache Spark;</p></li>
<li><p><strong>отсутствие возможности отслеживать изменение данных</strong> и эволюцию схемы, в отличие от, например, Avro, другого популярного форматом Big Data, изменение схемы данных которого легко прослеживается через графический интерфейс Sсhema Registry в Apache Kafka Confluent (об этом мы писали здесь). Отметим, что Apache Spark позволяет объединять схемы данных при изменении их со временем, но для этого требуется указать специальную опцию при чтении. А, чтобы что-то изменить в уже существующим файле, его придется перезаписать или добавить новую колонку.</p></li>
<li><p><strong>не поддерживаются транзакции</strong>, поскольку, несмотря на некоторую схожесть с базой данных (в части строгой типизации), файлы формата Паркет– это частично размеченная информация.</p></li>
<li><p><strong>сложность частичной потоковой передачи данных</strong> - необходимо передавать всю «группу строк»;</p></li>
<li><p><strong>сильная привязка к метаданным</strong> – при повреждении, потере метаданных или изменении контрольной суммы группы строк, блока данных столбца или страницы данных, вся смысловая информация будет утеряна. Отметим, что, отключив в файловой системе вычисления контрольных сумм на каждом из уровней разбиения, можно значительно повысить производительность;</p></li>
<li><p><strong>Паркетнеявляется человекочитаемым форматом</strong>, в отличие, например, от JSON или CSV.</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p><strong>gõ dữ liệu nghiêm ngặt</strong> – do hướng cột, tệp định dạng Parquet hoạt động giống như một bảng hoặc cơ sở dữ liệu bất biến khi loại dữ liệu cho một cột được xác định rõ ràng và không thể thay đổi hoặc kết hợp nó, chẳng hạn như: bằng cách kết hợp json lồng nhau với ý nghĩa chuỗi đơn giản.</p></li>
<li><p><strong>thiếu hỗ trợ tích hợp (gốc)</strong> trong các khung Dữ liệu lớn khác ngoại trừ Apache Spark;</p></li>
<li><p><strong>thiếu khả năng theo dõi các thay đổi dữ liệu</strong> và tiến hóa lược đồ, chẳng hạn như Avro, một định dạng Dữ liệu lớn phổ biến khác, những thay đổi trong lược đồ dữ liệu có thể dễ dàng theo dõi thông qua giao diện đồ họa Schema Register trong Apache Kafka Confluent (chúng tôi đã viết về điều này ở đây). Lưu ý rằng Apache Spark cho phép bạn hợp nhất các lược đồ dữ liệu khi chúng thay đổi theo thời gian, nhưng điều này yêu cầu bạn chỉ định một tùy chọn đặc biệt khi đọc. Và để thay đổi nội dung nào đó trong tệp hiện có, bạn sẽ phải ghi đè lên tệp đó hoặc thêm cột mới.</p></li>
<li><p><strong>giao dịch không được hỗ trợ</strong>, bởi vì, mặc dù có một số điểm tương đồng với cơ sở dữ liệu (về mặt gõ nghiêm ngặt), các tệp định dạng Parquet vẫn được đánh dấu một phần thông tin.</p></li>
<li><p><strong>sự phức tạp của việc truyền dữ liệu một phần</strong> - cần phải truyền toàn bộ “nhóm hàng”;</p></li>
<li><p><strong>ràng buộc chặt chẽ với siêu dữ liệu</strong> – nếu siêu dữ liệu bị hỏng, bị mất hoặc tổng kiểm tra của một nhóm hàng, khối dữ liệu cột hoặc trang dữ liệu bị thay đổi thì tất cả thông tin ngữ nghĩa sẽ bị mất. Lưu ý rằng bằng cách vô hiệu hóa tính toán tổng kiểm tra ở mỗi cấp độ phân vùng trong hệ thống tệp, hiệu suất có thể được cải thiện đáng kể;</p></li>
<li><p><strong>Sàn gỗ không phải là định dạng mà con người có thể đọc được</strong>, không giống như JSON hoặc CSV chẳng hạn.</p></li>
</ul>
</section>
</section>
<section id="dataframe-spark-sql">
<h2>Наборы DataFrame и Spark SQL<a class="headerlink" href="#dataframe-spark-sql" title="Link to this heading">¶</a></h2>
<p>Интерфейсы <strong>DataFrame</strong> и <strong>Dataset Модуля Spark SQL</strong> обеспечивают более эффективные варианты хранения данных, продвинутый оптимизатор и операции непосредственно над сериализованными данными.</p>
<p>**Giao diện <strong>DataFrame</strong> và <strong>Bộ dữ liệu của Mô-đun Spark SQL</strong> cung cấp các tùy chọn lưu trữ dữ liệu hiệu quả hơn, trình tối ưu hóa nâng cao và các thao tác trực tiếp trên dữ liệu được tuần tự hóa.</p>
<hr class="docutils" />
<p>Наборы DataFrame и Dataset представляют собой распределенные коллекции с отсутствующей в RDD дополнительной информацией о схеме.</p>
<p>DataFrames và Datasets là các bộ sưu tập được phân phối với thông tin lược đồ bổ sung bị thiếu trong RDD.</p>
<figure class="align-default">
<img alt="../_images/4-6.png" src="../_images/4-6.png" />
</figure>
<ul class="simple">
<li><p>Набор DataFrame представляет собой набор Dataset специальных объектов типа Row у которого отсутствует какая либо проверка типа на этапе компиляции.</p></li>
<li><p>Наборы DataFrame представляют собой распределенные коллекции с отсутствующей в RDD дополнительной информацией о схеме.</p></li>
<li><p>Посравнению с применением наборов RDD при обращении к DataFrame оптимизатор Spark может лучше понять наш код и наши данные, благодаря чему становится оптимизация лучше.</p></li>
<li><p>Наборы DataFrame модуля Spark SQL позволяет работать с наборами DataFrame, не прибегая к регистрации временных таблиц или генерации SQL-выражений.</p></li>
<li><p>НаборыDataFrame включает как преобразования, так и действия.</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p>Tập DataFrame là tập hợp các Dataset gồm các đối tượng đặc biệt thuộc kiểu Row và không được kiểm tra kiểu ở giai đoạn biên dịch.</p></li>
<li><p>DataFrames là các bộ sưu tập được phân phối với thông tin lược đồ bổ sung bị thiếu trong RDD.</p></li>
<li><p>So với việc sử dụng bộ RDD khi truy cập DataFrame, trình tối ưu hóa Spark có thể hiểu mã và dữ liệu của chúng tôi tốt hơn, dẫn đến tối ưu hóa tốt hơn.</p></li>
<li><p>Bộ khung dữ liệu Mô-đun Spark SQL cho phép bạn làm việc với các bộ DataFrame mà không cần phải đăng ký các bảng tạm thời hoặc tạo biểu thức SQL.</p></li>
<li><p>Bộ DataFrame bao gồm cả chuyển đổi và hành động.</p></li>
</ul>
<figure class="align-default">
<img alt="../_images/4-7.png" src="../_images/4-7.png" />
</figure>
<ul class="simple">
<li><p>Объект SparkSession обычно создается с помощью паттерна «Строитель» (Builder) и метода <code class="docutils literal notranslate"><span class="pre">getOrCreate()</span></code>, возвращающего текущий сеанс, если таковой уже существует.</p></li>
<li><p>«Строитель» принимает на входе ключи конфигурации в строковом виде <code class="docutils literal notranslate"><span class="pre">config(key,</span> <span class="pre">value)</span></code> и сокращения, имеющиеся для множества распространенных параметров.</p></li>
<li><p>enableHiveSupport(), обеспечивающее доступ к пользовательским функциям UDF СУБД Hive без необходимости установить Hive</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p>Đối tượng SparkSession thường được tạo bằng cách sử dụng mẫu Builder và phương thức <code class="docutils literal notranslate"><span class="pre">getOrCreate()</span></code> để trả về phiên hiện tại nếu đã tồn tại.</p></li>
<li><p>“Builder” nhận làm khóa cấu hình đầu vào ở dạng chuỗi <code class="docutils literal notranslate"><span class="pre">config(key,</span> <span class="pre">value)</span></code> và các chữ viết tắt có sẵn cho nhiều tham số phổ biến.</p></li>
<li><p>EnableHiveSupport(), cung cấp quyền truy cập vào các chức năng người dùng Hive DBMS UDF mà không cần cài đặt Hive</p></li>
</ul>
<figure class="align-default">
<img alt="../_images/4-8.png" src="../_images/4-8.png" />
</figure>
<ul class="simple">
<li><p>Объект SparkContext Можно использовать его для создания RDD из локального объекта Scala (с применением одного из методов makeRDD или parallelize) или с помощью чтения данных из устойчивого.</p></li>
<li><p>Объекты DataFrame и Dataset можно читать, задействуя SparkSession — объект Spark SQL, эквивалентный SparkContext.</p></li>
<li><p>ВSpark метод <code class="docutils literal notranslate"><span class="pre">createDataFrame()</span></code> используется для создания DataFrame вручную. Используя этот метод, вы можете создать Spark DataFrame из уже существующих объектов данных RDD.</p></li>
</ul>
<hr class="docutils" />
<ul class="simple">
<li><p>Đối tượng SparkContext Bạn có thể sử dụng nó để tạo RDD từ một đối tượng Scala cục bộ (sử dụng một trong các phương thức makeRDD hoặc song song) hoặc bằng cách đọc dữ liệu từ Persist.</p></li>
<li><p>Các đối tượng DataFrame và Dataset có thể được đọc bằng SparkSession, một đối tượng Spark SQL tương đương với SparkContext.</p></li>
<li><p>Trong Spark, phương thức <code class="docutils literal notranslate"><span class="pre">createDataFrame()</span></code> được sử dụng để tạo DataFrame theo cách thủ công. Sử dụng phương pháp này, bạn có thể tạo Spark DataFrame từ các đối tượng dữ liệu RDD hiện có.</p></li>
</ul>
<figure class="align-default">
<img alt="../_images/4-9.png" src="../_images/4-9.png" />
</figure>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./database"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../russian/README.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Русский язык</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="lecture-3.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Лекция 3. Apache Spark: Часть 1</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Лекция 4. Apache Spark: Часть 2</a><ul>
<li><a class="reference internal" href="#id1">Структура задания</a></li>
<li><a class="reference internal" href="#id2">Пример структуры задания</a></li>
<li><a class="reference internal" href="#rdd">Основные свойства RDD</a></li>
<li><a class="reference internal" href="#id3">Широкие и узкие зависимости</a></li>
<li><a class="reference internal" href="#big-data">Форматы файлов Big Data</a></li>
<li><a class="reference internal" href="#big-data-parquet">Форматы файлов Big Data/Parquet</a><ul>
<li><a class="reference internal" href="#id4">Плюсы</a></li>
<li><a class="reference internal" href="#id5">Минусы</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dataframe-spark-sql">Наборы DataFrame и Spark SQL</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    </body>
</html>